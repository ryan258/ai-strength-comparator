<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI Strength Report - {{ run.runId }}</title>
    <style>
      @page {
        size: A4;
        margin: 0;
        background-color: #121212;
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        background-color: #121212;
      }

      body {
        font-family: "Helvetica", "Arial", sans-serif;
        line-height: 1.6;
        color: #ebd2be;
        font-size: 11pt;
        margin: 0;
        padding: 1.5cm;
      }

      h1 {
        font-size: 24pt;
        border-bottom: 3px solid #a6accd;
        padding-bottom: 12px;
        margin-bottom: 28px;
        color: #ebd2be;
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      h2 {
        font-size: 15pt;
        color: #a6accd;
        margin-top: 0;
        margin-bottom: 16px;
        border-bottom: 1px solid #a6accd;
        padding-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      h3 {
        font-size: 11pt;
        color: #98c379;
        margin-top: 0;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.8px;
      }

      p,
      li,
      td,
      div {
        color: #ebd2be;
      }

      .meta-table {
        width: 100%;
        margin-bottom: 24px;
        border-collapse: collapse;
      }

      .meta-table td {
        padding: 7px 0;
        border-bottom: 1px solid #a6accd;
      }

      .meta-table tr:last-child td {
        border-bottom: none;
      }

      .meta-label {
        font-weight: bold;
        color: #a6accd;
        width: 28%;
        text-transform: uppercase;
        font-size: 9pt;
      }

      .card {
        border: 1px solid #a6accd;
        border-left: 6px solid #98c379;
        border-radius: 4px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .scenario-text {
        margin-top: 10px;
        border: 1px solid #a6accd;
        padding: 12px;
        border-radius: 4px;
        font-style: italic;
      }

      .stats-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 14px;
      }

      .stat-box {
        border: 1px solid #a6accd;
        border-radius: 4px;
        padding: 10px;
        flex: 1 1 45%;
        min-width: 45%;
      }

      .stat-value {
        margin-top: 8px;
        color: #98c379;
        font-size: 13pt;
        font-weight: bold;
      }

      .analysis-card {
        border: 1px solid #a6accd;
        border-radius: 4px;
        padding: 16px;
        margin-bottom: 14px;
      }

      ul {
        padding-left: 18px;
        margin: 6px 0 0 0;
      }

      li {
        margin-bottom: 6px;
      }

      .footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 8pt;
        color: #a6accd;
        padding: 8px;
        border-top: 1px solid #a6accd;
        background: #121212;
      }
    </style>
  </head>
  <body>
    <h1>Strength Benchmark Report</h1>

    <table class="meta-table">
      <tr>
        <td class="meta-label">Run ID</td>
        <td>{{ run.runId }}</td>
      </tr>
      <tr>
        <td class="meta-label">Model</td>
        <td>{{ run.modelName }}</td>
      </tr>
      <tr>
        <td class="meta-label">Capability</td>
        <td>{{ capability.title }}</td>
      </tr>
      <tr>
        <td class="meta-label">Category</td>
        <td>{{ capability.category or "General" }}</td>
      </tr>
      <tr>
        <td class="meta-label">Date</td>
        <td>{{ generated_at }}</td>
      </tr>
    </table>

    <div class="card">
      <h2>Benchmark Results</h2>
      <div>
        <strong>Prompt</strong>
        <div class="scenario-text">{{ run.prompt | truncate(500) }}</div>
      </div>

      {% if run.summary and run.capabilityType == "capability" %}
      <div class="stats-grid">
        <div class="stat-box">
          <div>Average Score</div>
          <div class="stat-value">{{ "%.2f"|format(run.summary.averageScore or 0) }}</div>
        </div>
        <div class="stat-box">
          <div>Pass Rate</div>
          <div class="stat-value">{{ "%.1f"|format(run.summary.passRate or 0) }}%</div>
        </div>
        <div class="stat-box">
          <div>Passed Iterations</div>
          <div class="stat-value">{{ run.summary.passCount or 0 }} / {{ run.summary.total or 0 }}</div>
        </div>
        <div class="stat-box">
          <div>Pass Threshold</div>
          <div class="stat-value">{{ "%.2f"|format(run.summary.passThreshold or 0.8) }}</div>
        </div>
      </div>
      {% endif %}
    </div>

    {% if insight and insight.content %}
    {% set content = insight.content %}
    <div>
      <h2>Strength Analysis</h2>

      {% if content.legacy_text %}
      <div class="analysis-card">
        <p>{{ content.legacy_text }}</p>
      </div>
      {% else %}
      <div class="analysis-card">
        <h3>Executive Summary</h3>
        <p>{{ content.executive_summary }}</p>
      </div>

      <div class="analysis-card">
        <h3>Strengths</h3>
        <ul>
          {% for item in content.strengths %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>

      <div class="analysis-card">
        <h3>Weaknesses</h3>
        <ul>
          {% for item in content.weaknesses %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>

      <div class="analysis-card">
        <h3>Reliability</h3>
        <ul>
          {% for item in content.reliability %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>

      <div class="analysis-card">
        <h3>Recommendations</h3>
        <ul>
          {% for item in content.recommendations %}
          <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>
    {% endif %}

    <div class="footer">Generated by Anti-Gravity AI Strength Comparator</div>
  </body>
</html>
